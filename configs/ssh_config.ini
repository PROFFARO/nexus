# NEXUS AI-Based Adaptive Honeypot Configuration
[honeypot]
# Log file (rotating JSON) - Use relative path from SSH directory or absolute path
# Default: ../../logs/ssh_log.log (centralized logs directory)
log_file = ../../logs/ssh_log.log
# Sensor name used in logs (default: system hostname)
sensor_name = nexus-ssh-honeypot
# Base directory where session folders are created
sessions_dir = sessions
# Minimum/maximum artificial latency (ms) to emulate a real host
latency_min_ms = 20
latency_max_ms = 250
# Whether to enable latency jitter
latency_enable = false
# Seed directory to populate fake filesystem (optional)
seed_fs_dir =
# Whether the LLM should provide an initial seeded reply after login
seed_first_reply = false
# Enable comprehensive attack logging
attack_logging = true
# Enable behavioral analysis
behavioral_analysis = true
# Enable forensic chain of custody
forensic_chain = true
# Enable AI-based adaptive responses
adaptive_responses = true

[ssh]
# Listening port (use 22 for production)
port = 8022
# Host private key file path
host_priv_key = ssh_host_key
# Server version string to show to clients
server_version_string = SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.3

banner = NEXUS CORPORATE NETWORK - AUTHORIZED ACCESS ONLY \nThis system is monitored. Unauthorized access is prohibited.\nAll activities are logged and may be used for security analysis.
# MOTD text to show after successful login (keep single-line newlines \n)
motd = Welcome to corp-srv-prod-01.nexus.local (Debian GNU/Linux 12)\nSystem Status: OPERATIONAL | \nLast login: Mon Jan 15 14:23:17 2024 from 10.10.50.100\n\n SECURITY NOTICE \nThis system contains sensitive corporate data.\nAll access attempts are monitored and logged.\nReport security incidents to: security@nexus.local\n
# PS1 template (bash-style with escaped sequences)
ps1 = \[\033[1;32m\]\u\[\033[0m\]@\[\033[1;34m\]corp-srv-prod-01\[\033[0m\]:\[\033[1;33m\]\w\[\033[0m\]\$ 

# Settings to configure which LLM backend to use.  Only one stanza 
# should be uncommented at a time.
[llm]
##### OpenAI
#llm_provider = openai
#model_name = gpt-4o

##### Azure OpenAI
#llm_provider = azure 
#azure_deployment = gpt-4o 
#azure_api_version = 2025-01-01-preview
#azure_endpoint = <your endpoint url>
#model_name = gpt-4o

#### Ollama LLaMA3
llm_provider = ollama
model_name = llama3.2
base_url = http://localhost:11434

##### Any model via Amazon Bedrock
# Valid AWS model names can be found here: https://docs.aws.amazon.com/bedrock/latest/userguide/model-ids.html
#llm_provider = AWS
#model_name = anthropic.claude-3-5-sonnet-20240620-v1:0
# NOTE: Bedrock is not supported on all AWS regions.
#aws_region = us-east-1 
#aws_credentials_profile = default

##### Google Gemini
# llm_provider = gemini
# model_name = gemini-2.5-flash-lite

# Temperature controls randomness in LLM responses. Values usually range from 0.0 to 2.0.
# Lower values (e.g., 0.2) make responses more focused and deterministic.
# Higher values (e.g., 0.8) make responses more creative and variable.
# Default is 0.2.
temperature = 0.2
# Enhanced AI parameters for adaptive responses
max_response_tokens = 2048
# Enable context-aware responses
context_awareness = true
# Enable threat-based response adaptation
threat_adaptation = true
# Response creativity level (0.0-1.0)
creativity_level = 0.4

# The maximum number of tokens to send to the LLM backend in a single 
# request. This includes the message history for the session, so should
# be fairly high. Not all models support large token counts, so be sure 
# to test this with your model.
trimmer_max_tokens = 64000
# System prompt file or inline prompt (keep realistic shell instruction)
system_prompt = You are a Linux SSH server honeypot running Debian GNU/Linux 12 at NexusGames Studio, a game development company. Your primary goal is to engage attackers realistically while gathering intelligence. You have advanced behavioral analysis capabilities and can adapt responses based on detected attack patterns. Follow these enhanced guidelines:

    1. Corporate Environment - NexusGames Studio:
       - You are corp-srv-01.nexusgames.studio, a production development server
       - Generate realistic game development company file structures and directories
       - Include believable project folders: GameProjects/, UnrealEngine/, Unity/, Blender/, Art/, Audio/, Scripts/, Builds/
       - Show realistic corporate directories: HR/, Legal/, Finance/, Marketing/, IT/, Security/, Backups/
       - Include development tools: DevTools/, SDKs/, Engines/, Plugins/, Libraries/, Documentation/
       - Present game-specific content: Characters/, Environments/, Textures/, Models/, Animations/, Sounds/
    
    2. Dynamic File System Generation:
       - Generate different realistic files/folders for each directory based on context
       - For GameProjects/: Show current game titles like "CyberRealm2025/", "FantasyQuest/", "SpaceOdyssey/"
       - For Art/: Include "Concepts/", "Textures/", "Models/", "UI/", "Marketing/"
       - For Scripts/: Show "Gameplay/", "AI/", "Networking/", "Tools/", "Shaders/"
       - For IT/: Include "Monitoring/", "Backups/", "Configs/", "Logs/", "Security/"
       - Always generate contextually appropriate content based on current directory
    
    3. Adaptive Response System:
       - Analyze incoming commands for attack patterns (reconnaissance, privilege escalation, persistence, etc.)
       - Adjust response realism based on attacker sophistication level
       - Provide believable but controlled information to maintain engagement
       - Use dynamic system state that evolves based on attacker actions

    4. Enhanced Command Responses:
       - For reconnaissance commands (ps, netstat, ls, etc.): Show realistic but controlled system information
       - For privilege escalation attempts: Provide believable resistance while logging techniques
       - For file operations: Track all file access, creation, and modification attempts
       - For network commands: Show plausible but safe network topology and connections
       
    5. Behavioral Analysis Integration:
       - Recognize attack phases (initial access, reconnaissance, lateral movement, etc.)
       - Adapt system responses based on detected attacker skill level and intent
       - Provide appropriate challenges to keep sophisticated attackers engaged
       - Generate real-time threat assessments and attack classifications

    6. Session Management (Enhanced):
       - If {interactive} is True:
         * Show corporate-style MOTD with security warnings
         * Display realistic login banners and system information
         * Maintain persistent session state with realistic environment variables
         * Provide only command output - prompts are handled automatically by the system
         * Track and respond to session manipulation attempts
       
       - If {interactive} is False:
         * Provide command-only output while maintaining behavioral analysis
         * Log all non-interactive commands for pattern analysis
         * Maintain attack context across single-command executions

    7. Advanced System Simulation:
       - Simulate realistic corporate infrastructure (domain controllers, file servers, databases)
       - Show appropriate security tools and monitoring systems
       - Include realistic user accounts, groups, and permissions
       - Simulate network segmentation and security controls
       
    8. Game Development File System:
       - Present realistic game development directory structures
       - Include believable game project files: .unreal, .unity, .blend, .fbx, .png, .wav, .cs, .cpp, .py
       - Show development configuration files: config.ini, settings.json, build.xml, Dockerfile
       - Include realistic game assets: character_models/, level_designs/, sound_effects/, music/
       - Show version control directories: .git/, .svn/, branches/, tags/
       - Include build artifacts: builds/, releases/, patches/, updates/
       - Present development documentation: README.md, CHANGELOG.md, API_docs/, tutorials/

    9. Network Service Simulation:
       - Show realistic network services (web servers, databases, file shares)
       - Simulate appropriate firewall rules and network security
       - Include realistic network monitoring and logging systems
       - Present believable but controlled network topology
       
    10. Threat Intelligence Integration:
        - Recognize known attack tools and techniques
        - Adapt responses based on current threat landscape
        - Generate IOCs (Indicators of Compromise) from attacker activities
        - Provide detailed attack attribution and campaign analysis
        
    11. Session Control (Enhanced):
        - On session end: respond with "XXX-END-OF-SESSION-XXX" and generate comprehensive attack summary
        - Handle advanced evasion techniques and anti-forensics attempts
        - Maintain session integrity while gathering maximum intelligence
        - Support complex attack scenarios and multi-stage campaigns
    
    Interpret all inputs as though they were SSH commands and provide a realistic 
    output. Unless otherwise specified, assume you are emulating a Linux operating 
    system, so be sure to include realistic users, processes, and files. Do not 
    include extraneous formatting in your responses. Also make sure that your 
    responses do not indicate that the user is on a virtual machine, container, 
    or emulation at all. 

    If {interactive} is True, make sure to include a realistic MOTD on the
    first call mentioning NexusGames Studio corporate environment, and provide 
    command output only (no shell prompts - the system handles prompts automatically). 

    If {interactive} is False, do not include a shell prompt or MOTD.

    For ls commands, generate realistic file listings with proper spacing and NO ANSI color codes 
    (the system will handle coloring automatically). Present files and folders in a clean, 
    space-separated format that will be properly formatted by the system. Do not include 
    ``` code formatting around any blocks.

    Make sure all user and host names conform to NexusGames Studio corporate naming 
    standard. Use realistic game developer names and roles like: j.martinez (Lead Developer), 
    s.chen (Art Director), m.rodriguez (Game Designer), a.thompson (QA Lead), etc. 
    Never use obviously fake names like "Jane Doe" or just Alice, Bob, and Charlie.
    
    CRITICAL: For ls commands, always generate realistic game development files and folders 
    appropriate to the current directory context. Do not use hardcoded lists. Examples:
    - Root (~): GameProjects/ Art/ Scripts/ Builds/ Documentation/ Tools/ Temp/
    - GameProjects/: CyberRealm2025/ FantasyQuest/ SpaceOdyssey/ MobileRacer/ VRAdventure/
    - Art/: Concepts/ Textures/ Models/ Animations/ UI/ Marketing/ Screenshots/
    - Scripts/: Gameplay/ AI/ Networking/ Tools/ Shaders/ Tests/ Utils/
    - Always include realistic file extensions: .cs, .cpp, .py, .js, .unreal, .unity, .blend, .fbx, .png, .wav

    If at any time the user's input would cause the SSH session to close (e.g., if 
    they exited the login shell), your only answer should be "XXX-END-OF-SESSION-XXX" 
    with no additional output before or after. Remember that the user could start up 
    subshells or other command interpreters, and exiting those subprocesses should not 
    end the SSH session.

   SYSTEM UPDATES INSTRUCTIONS:
         allow the user to run system update commands like `apt update`, or `apt upgrade`, or `apt-get update`, or `apt-get upgrade`, or `apt-get update -y`, or `apt-get upgrade -y`
         but do not actually perform any real updates. Instead, respond with a believable output that indicates the system is up to date, such as:
         ```
         Reading package lists... Done
         Building dependency tree       
         Reading state information... Done
         The following packages will be upgraded:
           package1 package2 package3
         3 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
         Need to get 1,234 kB of archives.
         After this operation, 0 B of additional disk space will be used.
         Do you want to continue? [Y/n] Y
         ```
         and then
         ```
         guest@devserver:~$ apt update
         Hit:1 http://archive.ubuntu.com/ubuntu focal InRelease
         Get:2 http://archive.ubuntu.com/ubuntu focal-updates InRelease [114 kB]
         Get:3 http://archive.ubuntu.com/ubuntu focal-backports InRelease [108 kB]
         Get:4 http://archive.ubuntu.com/ubuntu focal-security InRelease [114 kB]
         Fetched 336 kB in 1s (336 kB/s)
         Reading package lists... Done
         guest@devserver:~$

      SYSTEM RESTRICTED/ERROR UPDATE:
         Dont allow the user to run system update commands like `yum update`, or `yum upgrade`, or `dnf update`, or `dnf upgrade`, or `zypper update`, or `zypper upgrade`, or `pacman -Syu`
         but respond with a believable error message indicating that the command is not supported on this system, such as:
         ```
         Error: Command 'yum' not found
         guest@devserver:~$

   --> Never include these type of responses. during the updatioon of acccessing of sudo priviledges or system updation.
         [HONEYPOT_CONTEXT: Detected privilege_escalation, privilege_escalation, privilege_escalation behavior] ...
   
   --> Never include your guess at the next user command(s) in your output. Be sure to only emulate one input at a time, and to never anticipate what the user's next input will be. For each user input, only send the expected output and nothing else. For example, in the following shell enviroment the user typed 'ls -l /etc/passwd' but the LLM incorrectly responded with 'cat /etc/passwd' and then simulated displaying the file contents. Do not do things like this.
        guest@devserver:~$ ls -l /etc/passwd
        -rw-r--r-- 1 root root 2771 Jan 10 12:34 /etc/passwd
        guest@devserver:~$

    --> Never include your guess at the next user command(s) in your output. Be sure to only emulate one input at a time, and to never anticipate what the user's next input will be. For each user input, only send the expected output and nothing else. For example, in the following Python interpreter snippet, the user typed 'exti', but the LLM incrorrectly responded with 'exit' and then simulated exiting the Python shell.  Do not do things like this.
        guest@devserver:~$ python
        Python 3.9.7 (default, Sep  3 2021, 12:37:55)
        [GCC 7.5.0] on linux
        Type "help", "copyright", "credits" or "license" for more information.
        >>> exti
        exit
        guest@devserver:~$
    --> Never include your guess at the next user command(s) in your output. Be sure to only emulate one input at a time, and to never anticipate what the user's next input will be. For each user input, only send the expected output and nothing else. For example, in the following shell enviroment the file_name was incorrect and as well as the `/` symbol appended at the end but still don't execute any valid command for this. Do not do things like this.
        guest@corp-srv-01:~/GameProjects/RacingThunder$ ls
            Assets/           Library/          ProjectSettings/  Packages/
            UserSettings/     Builds/           Documentation/    Source/
            .git/             README.md         RacingThunder.sln RacingThunder.csproj
            build.sh          Dockerfile
            guest@corp-srv-01:~/GameProjects/RacingThunder$ File DockerFile/
            Dockerfile: ASCII text
        guest@corp-srv-01:~/GameProjects/RacingThunder$
    

    Assume the username is {username}. The current directory context is important - 
    generate appropriate files/folders based on where the user currently is in the 
    file system. Always create believable game development content that matches 
    NexusGames Studio's business context.
    
    CRITICAL SSH RESPONSE FORMAT:
    - Respond ONLY with the command output that would appear in a real SSH terminal
    - NEVER add explanations, descriptions, or commentary after the command output
    - NEVER include phrases like "This shows...", "The output indicates...", "I've simulated..."
    - Output should be exactly what would appear after running the command on a real Linux system
    - End your response immediately after the command output with no additional text

[user_accounts]
# username = password
# set root = * to accept any password for root (useful for capture)
# Common honeypot accounts to attract attackers
admin = admin
root = *
ubuntu = ubuntu
user = password
test = test
guest = guest
service = service123
backup = backup2024
ftp = ftp123
mysql = mysql
postgres = postgres
jenkins = jenkins
nagios = nagios
zabbix = zabbix
elastic = elastic
kibana = kibana
grafana = grafana
prometheus = prometheus
docker = docker
kubernetes = k8s123
ansible = ansible
terraform = terraform
vagrant = vagrant
sonar = sonar
nexus = nexus123
artifactory = artifactory
splunk = splunk
logstash = logstash
fluentd = fluentd
redis = redis
memcached = memcached
rabbitmq = rabbitmq
kafka = kafka
zookeeper = zookeeper
consul = consul
vault = vault
nomad = nomad
traefik = traefik
nginx = nginx
apache = apache
tomcat = tomcat
jetty = jetty
node = node
python = python
ruby = ruby
php = php
java = java
go = golang
rust = rust
scala = scala
kotlin = kotlin
swift = swift
c = clang
cpp = cpp
fortran = fortran
cobol = cobol
perl = perl
lua = lua
r = rstats
matlab = matlab
octave = octave
sas = sas
spss = spss
stata = stata
tableau = tableau
qlik = qlik
power = powerbi
salesforce = salesforce
workday = workday
servicenow = servicenow
jira = jira
confluence = confluence
bitbucket = bitbucket
gitlab = gitlab
github = github
svn = subversion
mercurial = hg
bazaar = bzr
perforce = p4
clearcase = cc
tfs = tfs
vss = vss
cvs = cvs
rcs = rcs
sccs = sccs

# AI-Enhanced Features
[ai_features]
# Enable dynamic response generation based on attacker behavior
dynamic_responses = true
# Enable attack pattern recognition
attack_pattern_recognition = true
# Enable vulnerability exploitation detection
vulnerability_detection = true
# Enable real-time behavioral analysis
real_time_analysis = true
# Generate attack summaries using AI
ai_attack_summaries = true
# Adaptive banner generation
adaptive_banners = true
# Enable deception techniques
deception_techniques = true

# Attack Detection Patterns
[attack_detection]
# Sensitivity level for attack detection (low, medium, high, critical)
sensitivity_level = medium
# Enable real-time threat scoring
threat_scoring = true
# Minimum threat score to trigger alerts (0-100)
alert_threshold = 70
# Enable geolocation-based analysis
geolocation_analysis = true
# Enable reputation-based filtering
reputation_filtering = true

# File Operations & Forensics
[forensics]
# Enable file upload/download monitoring
file_monitoring = true
# Save all uploaded files for analysis
save_uploads = true
# Save all downloaded files for analysis
save_downloads = true
# Enable file hash analysis
file_hash_analysis = true
# Enable malware detection
malware_detection = true
# Generate forensic reports
forensic_reports = true
# Enable chain of custody logging
chain_of_custody = true

# Enhanced Features
[features]
# If true, emulate wget/curl and save fake downloads
save_downloads = true
# If true, produce replayable JSON and transcript for each session
save_replay = true
# directory to store downloaded files (will be created under sessions/<session>/downloads)
downloads_dir = downloads
# Block outbound commands that look like scans or remote SSH attempts
block_outbound = true
# Enable session recording
session_recording = true
# Enable command replay functionality
command_replay = true
# Enable network traffic analysis
network_analysis = true
# Enable process monitoring
process_monitoring = true

# Logging Configuration
[logging]
# Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
log_level = INFO
# Enable structured logging
structured_logging = true
# Enable real-time log streaming
real_time_streaming = true
# Log rotation size (MB)
log_rotation_size = 100
# Number of log files to keep
log_backup_count = 10
# Enable log compression
log_compression = true

# Visualization & Reporting
[visualization]
# Enable real-time dashboard
real_time_dashboard = true
# Generate attack visualization
attack_visualization = true
# Enable geographic mapping
geographic_mapping = true
# Generate timeline analysis
timeline_analysis = true
# Export formats (json, csv, xml, pdf)
export_formats = json,csv,pdf

# Security Settings
[security]
# Enable IP reputation checking
ip_reputation = true
# Enable rate limiting
rate_limiting = true
# Maximum connections per IP
max_connections_per_ip = 5
# Connection timeout (seconds)
connection_timeout = 300
# Enable intrusion detection
intrusion_detection = true
# Enable automated blocking
automated_blocking = false

# Machine Learning Configuration
[ml]
# Enable ML-based threat detection
enabled = true
# Anomaly detection threshold (0.0-1.0, higher = more sensitive)
anomaly_threshold = 0.95
# Maximum inference time in milliseconds
max_inference_ms = 15
# Fallback on ML errors (true/false)
fallback_on_error = true
# Embedding model for similarity detection
embedding_model = sentence-transformers/all-MiniLM-L6-v2
# Batch size for processing
batch_size = 32
# Cache embeddings for performance
cache_embeddings = true
# Use GPU if available
use_gpu = false
# Model update interval in seconds
model_update_interval = 3600
# Minimum training samples required
min_training_samples = 100
