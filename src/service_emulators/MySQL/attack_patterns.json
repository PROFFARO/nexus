{
  "sql_injection": {
    "description": "SQL injection attacks targeting database queries",
    "patterns": [
      "'.*or.*1=1.*--",
      "'.*or.*'1'='1",
      "'.*or.*1=1.*#",
      "union.*select.*from",
      "union.*all.*select",
      "select.*from.*information_schema",
      "select.*from.*mysql\\.user",
      "select.*user\\(\\)",
      "select.*version\\(\\)",
      "select.*database\\(\\)",
      "select.*@@version",
      "select.*@@datadir",
      "select.*load_file\\(",
      "into.*outfile",
      "into.*dumpfile",
      "load.*data.*infile",
      "'.*and.*1=1.*--",
      "'.*and.*1=2.*--",
      "order.*by.*\\d+",
      "group.*by.*\\d+",
      "having.*1=1",
      "benchmark\\(",
      "sleep\\(",
      "pg_sleep\\(",
      "waitfor.*delay",
      "extractvalue\\(",
      "updatexml\\(",
      "exp\\(~\\(",
      "cast\\(.*as.*char\\)",
      "convert\\(.*using.*",
      "substring\\(.*from.*for",
      "ascii\\(.*substring\\(",
      "hex\\(.*substring\\(",
      "length\\(.*database\\(\\)\\)",
      "count\\(\\*\\).*from",
      "table_name.*from.*information_schema",
      "column_name.*from.*information_schema",
      "schema_name.*from.*information_schema"
    ],
    "severity": "critical",
    "indicators": [
      "sql_injection",
      "database_exploitation",
      "data_extraction",
      "union_based_injection",
      "blind_injection",
      "time_based_injection",
      "error_based_injection"
    ]
  },
  "reconnaissance": {
    "description": "Database reconnaissance and information gathering",
    "patterns": [
      "show.*databases",
      "show.*tables",
      "show.*columns",
      "show.*fields",
      "show.*index",
      "show.*grants",
      "show.*privileges",
      "show.*variables",
      "show.*status",
      "show.*processlist",
      "show.*engines",
      "show.*plugins",
      "show.*create.*table",
      "show.*create.*database",
      "describe.*",
      "desc.*",
      "explain.*",
      "select.*from.*information_schema\\.tables",
      "select.*from.*information_schema\\.columns",
      "select.*from.*information_schema\\.schemata",
      "select.*from.*information_schema\\.user_privileges",
      "select.*from.*information_schema\\.schema_privileges",
      "select.*from.*information_schema\\.table_privileges",
      "select.*from.*information_schema\\.column_privileges",
      "select.*from.*mysql\\.user",
      "select.*from.*mysql\\.db",
      "select.*from.*mysql\\.tables_priv",
      "select.*from.*mysql\\.columns_priv",
      "select.*@@version",
      "select.*@@hostname",
      "select.*@@datadir",
      "select.*@@basedir",
      "select.*@@tmpdir",
      "select.*@@log_error",
      "select.*user\\(\\)",
      "select.*current_user\\(\\)",
      "select.*session_user\\(\\)",
      "select.*system_user\\(\\)",
      "select.*database\\(\\)",
      "select.*schema\\(\\)"
    ],
    "severity": "medium",
    "indicators": [
      "database_enumeration",
      "schema_discovery",
      "privilege_enumeration",
      "system_information_gathering",
      "table_structure_analysis"
    ]
  },
  "privilege_escalation": {
    "description": "Attempts to gain higher database privileges",
    "patterns": [
      "grant.*all.*privileges",
      "grant.*super.*on",
      "grant.*file.*on",
      "grant.*process.*on",
      "grant.*reload.*on",
      "grant.*shutdown.*on",
      "grant.*create.*user.*on",
      "grant.*replication.*slave.*on",
      "grant.*replication.*client.*on",
      "create.*user.*identified.*by",
      "alter.*user.*identified.*by",
      "set.*password.*for",
      "update.*mysql\\.user.*set",
      "insert.*into.*mysql\\.user",
      "delete.*from.*mysql\\.user",
      "flush.*privileges",
      "select.*into.*outfile",
      "select.*into.*dumpfile",
      "load.*data.*local.*infile",
      "load_file\\(",
      "@@secure_file_priv",
      "@@global\\.secure_file_priv",
      "set.*@@global",
      "set.*global.*",
      "show.*master.*status",
      "show.*slave.*status",
      "change.*master.*to",
      "start.*slave",
      "stop.*slave",
      "reset.*slave",
      "reset.*master"
    ],
    "severity": "high",
    "indicators": [
      "privilege_escalation",
      "user_manipulation",
      "file_system_access",
      "global_variable_modification",
      "replication_abuse",
      "administrative_function_abuse"
    ]
  },
  "data_exfiltration": {
    "description": "Data theft and unauthorized data extraction",
    "patterns": [
      "select.*\\*.*from.*users",
      "select.*\\*.*from.*passwords",
      "select.*\\*.*from.*accounts",
      "select.*\\*.*from.*customers",
      "select.*\\*.*from.*employees",
      "select.*\\*.*from.*admin",
      "select.*\\*.*from.*credit_card",
      "select.*\\*.*from.*payment",
      "select.*\\*.*from.*financial",
      "select.*\\*.*from.*personal",
      "select.*\\*.*from.*sensitive",
      "select.*\\*.*from.*confidential",
      "select.*password.*from",
      "select.*email.*from",
      "select.*phone.*from",
      "select.*ssn.*from",
      "select.*credit.*from",
      "select.*hash.*from",
      "select.*salt.*from",
      "select.*token.*from",
      "select.*key.*from",
      "select.*secret.*from",
      "select.*into.*outfile.*'/tmp/",
      "select.*into.*outfile.*'/var/",
      "select.*into.*outfile.*'C:\\\\",
      "select.*into.*dumpfile.*'/tmp/",
      "select.*into.*dumpfile.*'/var/",
      "mysqldump",
      "backup.*database",
      "export.*data",
      "bulk.*extract",
      "data.*dump"
    ],
    "severity": "critical",
    "indicators": [
      "data_exfiltration",
      "sensitive_data_access",
      "bulk_data_extraction",
      "file_export",
      "credential_harvesting",
      "personal_information_theft"
    ]
  },
  "persistence": {
    "description": "Maintaining access to the database system",
    "patterns": [
      "create.*user.*'backdoor'",
      "create.*user.*'admin'",
      "create.*user.*'root'",
      "create.*user.*'system'",
      "create.*user.*'service'",
      "grant.*all.*privileges.*on.*\\*\\.\\*.*to",
      "grant.*super.*on.*\\*\\.\\*.*to",
      "create.*function.*.*returns.*string.*soname",
      "create.*function.*sys_exec.*returns.*string",
      "create.*function.*sys_eval.*returns.*string",
      "create.*procedure.*backdoor",
      "create.*trigger.*backdoor",
      "create.*event.*backdoor",
      "alter.*event.*backdoor",
      "set.*global.*event_scheduler.*=.*on",
      "insert.*into.*mysql\\.user.*values",
      "update.*mysql\\.user.*set.*password",
      "update.*mysql\\.user.*set.*authentication_string",
      "create.*database.*if.*not.*exists.*backdoor",
      "create.*table.*backdoor",
      "insert.*into.*backdoor",
      "select.*'<?php'.*into.*outfile",
      "select.*'<script>'.*into.*outfile",
      "load_file\\('/etc/passwd'\\)",
      "load_file\\('C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\drivers\\\\\\\\etc\\\\\\\\hosts'\\)"
    ],
    "severity": "critical",
    "indicators": [
      "backdoor_creation",
      "persistent_access",
      "user_account_creation",
      "privilege_assignment",
      "stored_procedure_backdoor",
      "trigger_backdoor",
      "event_scheduler_abuse",
      "web_shell_creation"
    ]
  },
  "lateral_movement": {
    "description": "Moving to other systems through database connections",
    "patterns": [
      "select.*into.*outfile.*'\\\\\\\\\\\\\\\\",
      "load.*data.*from.*'\\\\\\\\\\\\\\\\",
      "create.*server.*.*options",
      "create.*table.*.*engine.*=.*federated",
      "select.*from.*.*@.*",
      "insert.*into.*.*@.*",
      "update.*.*@.*",
      "delete.*from.*.*@.*",
      "show.*slave.*hosts",
      "show.*replicas",
      "change.*master.*to.*master_host",
      "start.*slave.*until",
      "set.*@@global\\.read_only.*=.*0",
      "set.*@@global\\.super_read_only.*=.*0",
      "federated.*engine",
      "connect.*server",
      "remote.*table",
      "network.*share",
      "unc.*path"
    ],
    "severity": "high",
    "indicators": [
      "lateral_movement",
      "network_traversal",
      "remote_table_access",
      "federated_engine_abuse",
      "replication_manipulation",
      "cross_server_queries"
    ]
  },
  "denial_of_service": {
    "description": "Attacks aimed at disrupting database service",
    "patterns": [
      "select.*benchmark\\(\\d+,",
      "select.*sleep\\(\\d+\\)",
      "select.*get_lock\\('.*',.*\\d+\\)",
      "create.*table.*as.*select.*\\*.*from.*information_schema",
      "insert.*into.*.*select.*\\*.*from.*information_schema",
      "update.*.*set.*.*=.*\\(select.*count\\(\\*\\).*from.*information_schema",
      "delete.*from.*.*where.*1=1",
      "drop.*database.*if.*exists",
      "drop.*table.*if.*exists",
      "truncate.*table",
      "alter.*table.*.*engine.*=.*memory",
      "create.*temporary.*table.*as.*select",
      "load.*data.*infile.*'/dev/zero'",
      "select.*\\*.*from.*information_schema\\.tables.*cross.*join",
      "select.*\\*.*from.*.*a.*cross.*join.*.*b",
      "union.*select.*null.*from.*information_schema\\.tables",
      "recursive.*cte",
      "with.*recursive"
    ],
    "severity": "high",
    "indicators": [
      "denial_of_service",
      "resource_exhaustion",
      "performance_degradation",
      "table_locking",
      "memory_consumption",
      "cpu_intensive_queries"
    ]
  },
  "malware_deployment": {
    "description": "Deploying malicious code through database functions",
    "patterns": [
      "select.*'<\\?php.*system\\(",
      "select.*'<\\?php.*exec\\(",
      "select.*'<\\?php.*shell_exec\\(",
      "select.*'<\\?php.*passthru\\(",
      "select.*'<script>.*eval\\(",
      "select.*'<script>.*document\\.write\\(",
      "into.*outfile.*'\\.\\./\\.\\./",
      "into.*outfile.*'/var/www/',",
      "into.*outfile.*'C:\\\\\\\\inetpub\\\\\\\\wwwroot\\\\\\\\",
      "create.*function.*.*returns.*string.*soname.*'.*\\.so'",
      "create.*function.*.*returns.*string.*soname.*'.*\\.dll'",
      "sys_exec",
      "sys_eval",
      "cmdshell",
      "xp_cmdshell",
      "sp_oacreate",
      "sp_oamethod",
      "openrowset",
      "opendatasource"
    ],
    "severity": "critical",
    "indicators": [
      "malware_deployment",
      "web_shell_creation",
      "code_injection",
      "file_system_manipulation",
      "udf_exploitation",
      "stored_procedure_abuse"
    ]
  },
  "credential_access": {
    "description": "Stealing or cracking database credentials",
    "patterns": [
      "select.*user,.*password.*from.*mysql\\.user",
      "select.*user,.*authentication_string.*from.*mysql\\.user",
      "select.*\\*.*from.*mysql\\.user",
      "select.*password.*from.*users",
      "select.*hash.*from.*users",
      "select.*salt.*from.*users",
      "select.*md5\\(",
      "select.*sha1\\(",
      "select.*sha2\\(",
      "select.*password\\(",
      "select.*old_password\\(",
      "select.*encrypt\\(",
      "select.*des_encrypt\\(",
      "select.*aes_encrypt\\(",
      "show.*grants.*for",
      "show.*create.*user",
      "select.*current_user\\(\\)",
      "select.*user\\(\\)",
      "select.*session_user\\(\\)",
      "select.*system_user\\(\\)",
      "brute.*force",
      "dictionary.*attack",
      "password.*crack"
    ],
    "severity": "high",
    "indicators": [
      "credential_access",
      "password_extraction",
      "hash_cracking",
      "user_enumeration",
      "privilege_discovery",
      "authentication_bypass"
    ]
  },
  "defense_evasion": {
    "description": "Avoiding detection and analysis",
    "patterns": [
      "set.*@@global\\.general_log.*=.*off",
      "set.*@@global\\.log_queries_not_using_indexes.*=.*off",
      "set.*@@global\\.slow_query_log.*=.*off",
      "set.*@@global\\.log_bin.*=.*off",
      "truncate.*table.*mysql\\.general_log",
      "delete.*from.*mysql\\.general_log",
      "alter.*table.*mysql\\.general_log.*engine.*=.*blackhole",
      "set.*@@session\\.sql_log_bin.*=.*0",
      "/\\*!.*\\*/",
      "/\\*!\\d+.*\\*/",
      "select.*0x[0-9a-f]+",
      "select.*char\\(",
      "select.*concat\\(",
      "select.*unhex\\(",
      "select.*hex\\(",
      "select.*ascii\\(",
      "select.*bin\\(",
      "select.*oct\\(",
      "obfuscation",
      "encoding",
      "hex.*encoding",
      "base64.*encoding"
    ],
    "severity": "high",
    "indicators": [
      "defense_evasion",
      "log_manipulation",
      "query_obfuscation",
      "encoding_evasion",
      "audit_bypass",
      "detection_avoidance"
    ]
  }
}