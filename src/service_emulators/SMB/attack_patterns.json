{
  "reconnaissance": {
    "description": "SMB share enumeration and system discovery",
    "patterns": [
      "net view", "net share", "dir \\\\\\\\", "ls \\\\\\\\", "smbclient -L",
      "enum4linux", "smbmap", "crackmapexec", "rpcclient",
      "nbtscan", "nmblookup", "smbstatus", "showmount",
      "net use \\\\\\\\.*\\\\.*", "net time \\\\\\\\", "net config",
      "wmic /node:", "psexec \\\\\\\\", "winrm", "invoke-command",
      "get-wmiobject", "get-ciminstance", "test-netconnection",
      "nmap.*smb", "nmap.*445", "nmap.*139", "masscan.*445"
    ],
    "severity": "medium",
    "indicators": [
      "share_enumeration", "network_discovery", "smb_scanning",
      "service_discovery", "host_enumeration"
    ]
  },
  "lateral_movement": {
    "description": "Moving laterally through SMB shares and systems",
    "patterns": [
      "psexec", "wmiexec", "smbexec", "atexec", "dcomexec",
      "winrm", "evil-winrm", "invoke-command", "enter-pssession",
      "net use.*\\\\c\\$", "net use.*\\\\admin\\$", "net use.*\\\\ipc\\$",
      "copy.*\\\\\\\\.*\\\\c\\$", "xcopy.*\\\\\\\\", "robocopy.*\\\\\\\\",
      "powershell.*-computername", "invoke-wmimethod",
      "sc.*\\\\\\\\.*create", "sc.*\\\\\\\\.*start", "at.*\\\\\\\\",
      "schtasks.*\\/s", "reg.*\\\\\\\\.*add", "wmic.*\\/node"
    ],
    "severity": "high",
    "indicators": [
      "remote_execution", "admin_share_access", "service_manipulation",
      "remote_registry", "scheduled_tasks", "wmi_execution"
    ]
  },
  "credential_harvesting": {
    "description": "Stealing or dumping credentials via SMB",
    "patterns": [
      "net user", "net localgroup", "net group", "net accounts",
      "wmic useraccount", "get-localuser", "get-aduser",
      "mimikatz", "sekurlsa", "lsadump", "dcsync", "golden",
      "ntlmrelayx", "smbrelayx", "responder", "inveigh",
      "hashcat", "john", "crackmapexec.*--sam", "secretsdump",
      "reg.*sam", "reg.*security", "reg.*system",
      "copy.*sam", "copy.*security", "copy.*system",
      "vssadmin.*create.*shadow", "ntdsutil", "diskshadow"
    ],
    "severity": "critical",
    "indicators": [
      "credential_dumping", "hash_extraction", "ntlm_relay",
      "password_cracking", "domain_enumeration", "privilege_escalation"
    ]
  },
  "data_exfiltration": {
    "description": "Stealing data through SMB shares",
    "patterns": [
      "copy.*\\\\\\\\.*\\\\.*", "xcopy.*\\/s", "robocopy.*\\/mir",
      "tar.*czf.*\\\\\\\\", "zip.*-r.*\\\\\\\\", "7z.*a.*\\\\\\\\",
      "powershell.*copy-item.*\\\\\\\\", "get-childitem.*\\\\\\\\.*-recurse",
      "findstr.*\\/s.*\\\\\\\\", "grep.*-r.*\\\\\\\\", "select-string.*\\\\\\\\",
      "type.*\\\\\\\\.*\\\\.*", "cat.*\\\\\\\\.*\\\\.*", "get-content.*\\\\\\\\",
      "dir.*\\/s.*\\\\\\\\", "ls.*-r.*\\\\\\\\", "find.*\\\\\\\\.*-name",
      "scp.*\\\\\\\\", "rsync.*\\\\\\\\", "curl.*-T.*\\\\\\\\",
      "wget.*--post-file.*\\\\\\\\", "invoke-webrequest.*\\\\\\\\.*-outfile"
    ],
    "severity": "critical",
    "indicators": [
      "bulk_file_copy", "recursive_download", "data_compression",
      "file_search", "sensitive_file_access", "network_transfer"
    ]
  },
  "persistence": {
    "description": "Maintaining access through SMB mechanisms",
    "patterns": [
      "copy.*\\.exe.*\\\\\\\\.*\\\\c\\$\\\\windows", "copy.*\\.dll.*\\\\\\\\.*\\\\c\\$\\\\system32",
      "sc.*\\\\\\\\.*create", "sc.*\\\\\\\\.*config", "net.*\\\\\\\\.*start",
      "schtasks.*\\/create.*\\/s", "at.*\\\\\\\\.*\\/interactive",
      "reg.*\\\\\\\\.*add.*run", "reg.*\\\\\\\\.*add.*runonce",
      "wmic.*\\/node.*process.*call.*create", "invoke-wmimethod.*win32_process",
      "powershell.*-windowstyle.*hidden.*\\\\\\\\", "cmd.*\\/c.*\\\\\\\\.*&",
      "net.*\\\\\\\\.*user.*\\/add", "net.*\\\\\\\\.*localgroup.*administrators.*\\/add",
      "copy.*backdoor.*\\\\\\\\", "copy.*shell.*\\\\\\\\", "copy.*payload.*\\\\\\\\"
    ],
    "severity": "critical",
    "indicators": [
      "service_persistence", "scheduled_task_persistence", "registry_persistence",
      "user_creation", "backdoor_installation", "remote_service_creation"
    ]
  },
  "privilege_escalation": {
    "description": "Escalating privileges through SMB vulnerabilities",
    "patterns": [
      "eternalblue", "ms17-010", "doublepulsar", "wannacry",
      "ms08-067", "conficker", "ms03-026", "ms06-040",
      "smb.*exploit", "smb.*vulnerability", "smb.*buffer.*overflow",
      "metasploit.*smb", "exploit.*smb", "payload.*smb",
      "psexec.*-s", "psexec.*system", "wmic.*\\/privileges",
      "whoami.*\\/priv", "net.*localgroup.*administrators",
      "runas.*\\/user:administrator", "su.*administrator"
    ],
    "severity": "critical",
    "indicators": [
      "smb_exploitation", "buffer_overflow", "privilege_abuse",
      "system_account_access", "administrator_access", "exploit_usage"
    ]
  },
  "defense_evasion": {
    "description": "Evading detection in SMB operations",
    "patterns": [
      "del.*\\\\\\\\.*\\\\.*\\.log", "rm.*\\\\\\\\.*\\\\.*\\.log", "remove-item.*\\\\\\\\.*log",
      "wevtutil.*cl", "wevtutil.*clear-log", "clear-eventlog",
      "reg.*\\\\\\\\.*delete.*audit", "auditpol.*\\/set.*\\/success:disable",
      "sc.*\\\\\\\\.*stop.*eventlog", "net.*\\\\\\\\.*stop.*eventlog",
      "taskkill.*\\/f.*\\/im.*sysmon", "sc.*\\\\\\\\.*delete.*sysmon",
      "copy.*\\/y.*nul.*\\\\\\\\.*\\\\.*\\.log", "echo.*>.*\\\\\\\\.*\\\\.*\\.log",
      "attrib.*\\+h.*\\\\\\\\", "icacls.*\\\\\\\\.*\\/deny", "cacls.*\\\\\\\\.*\\/d",
      "timestomp", "touch.*-t.*\\\\\\\\", "powershell.*-executionpolicy.*bypass"
    ],
    "severity": "high",
    "indicators": [
      "log_clearing", "audit_evasion", "file_hiding",
      "timestamp_manipulation", "security_tool_evasion", "permission_manipulation"
    ]
  },
  "malware_deployment": {
    "description": "Deploying malware through SMB shares",
    "patterns": [
      "copy.*\\.exe.*\\\\\\\\.*\\\\c\\$", "copy.*malware.*\\\\\\\\", "copy.*trojan.*\\\\\\\\",
      "copy.*backdoor.*\\\\\\\\", "copy.*payload.*\\\\\\\\", "copy.*shell.*\\\\\\\\",
      "xcopy.*\\.exe.*\\\\\\\\.*\\/y", "robocopy.*\\.exe.*\\\\\\\\",
      "powershell.*invoke-expression.*\\\\\\\\", "powershell.*iex.*\\\\\\\\",
      "certutil.*-urlcache.*\\\\\\\\", "bitsadmin.*\\/transfer.*\\\\\\\\",
      "mshta.*\\\\\\\\", "rundll32.*\\\\\\\\", "regsvr32.*\\\\\\\\",
      "wmic.*process.*call.*create.*\\\\\\\\", "sc.*\\\\\\\\.*create.*binpath.*\\\\\\\\",
      "schtasks.*\\/create.*\\/tr.*\\\\\\\\", "at.*\\\\\\\\.*cmd.*\\/c.*\\\\\\\\"
    ],
    "severity": "critical",
    "indicators": [
      "executable_deployment", "malware_installation", "remote_execution",
      "service_creation", "scheduled_execution", "living_off_land"
    ]
  },
  "vulnerability_exploitation": {
    "description": "Exploiting SMB-specific vulnerabilities",
    "patterns": [
      "eternalblue", "eternalromance", "eternalchampion", "eternalsynergy",
      "ms17-010", "ms08-067", "ms06-040", "ms03-026", "ms09-050",
      "cve-2017-0144", "cve-2008-4250", "cve-2006-3439", "cve-2003-0352",
      "smb.*ghost", "smbghost", "cve-2020-0796", "smbleed",
      "zerologon", "cve-2020-1472", "netlogon.*vulnerability",
      "petya", "notpetya", "wannacry", "conficker", "stuxnet",
      "doublepulsar", "fuzzbunch", "danderspritz", "equation.*group"
    ],
    "severity": "critical",
    "indicators": [
      "smb_vulnerability_exploitation", "remote_code_execution", "buffer_overflow",
      "authentication_bypass", "privilege_escalation", "worm_propagation"
    ]
  },
  "network_attacks": {
    "description": "Network-based attacks targeting SMB",
    "patterns": [
      "ntlmrelayx", "smbrelayx", "responder", "inveigh", "mitm6",
      "llmnr.*poison", "nbns.*poison", "mdns.*poison",
      "arp.*spoof", "arp.*poison", "ettercap", "bettercap",
      "smb.*relay", "ntlm.*relay", "kerberos.*relay",
      "smb.*downgrade", "smb.*negotiate", "smb.*hijack",
      "wireshark.*smb", "tcpdump.*445", "tshark.*smb",
      "nmap.*smb.*vuln", "nessus.*smb", "openvas.*smb"
    ],
    "severity": "high",
    "indicators": [
      "ntlm_relay_attack", "smb_relay", "network_poisoning",
      "man_in_the_middle", "protocol_downgrade", "traffic_interception"
    ]
  }
}