# NEXUS AI-Based Adaptive SMB Honeypot Configuration
[honeypot]
# Log file (rotating JSON) - Use relative path from SMB directory or absolute path
# Default: ../../logs/smb_log.log (centralized logs directory)
log_file = ../../logs/smb_log.log
# Sensor name used in logs (default: system hostname)
sensor_name = nexus-smb-honeypot
# Base directory where session folders are created
sessions_dir = sessions
# Minimum/maximum artificial latency (ms) to emulate a real host
latency_min_ms = 20
latency_max_ms = 250
# Whether to enable latency jitter  
latency_enable = false
# Enable comprehensive attack logging
attack_logging = true
# Enable behavioral analysis
behavioral_analysis = true
# Enable forensic chain of custody
forensic_chain = true
# Enable AI-based adaptive responses
adaptive_responses = true

[smb]
# Listening port (use 445 for production, 139 for NetBIOS)
port = 4445
# Server name/hostname
server_name = NEXUS-FS-01
# Workgroup/Domain name
workgroup = NEXUSGAMES
# Server banner message
banner = NexusGames Studio File Server v3.1.1
# Welcome message after authentication
welcome_message = Welcome to NexusGames Studio File Server\nAccess restricted to authorized personnel only.\nAll activities are monitored and logged.
# Maximum number of concurrent connections
max_connections = 100
# Connection timeout in seconds
connection_timeout = 300
# Enable SMB1 protocol (legacy)
enable_smb1 = true
# Enable SMB2/3 protocol
enable_smb2 = true
# Enable NetBIOS over TCP
enable_netbios = true
# Default share permissions
default_permissions = read
# Enable guest access
allow_guest = true
# Guest account name
guest_account = guest

# Settings to configure which LLM backend to use.  Only one stanza 
# should be uncommented at a time.
[llm]
##### OpenAI
#llm_provider = openai
#model_name = gpt-4o

##### Azure OpenAI
#llm_provider = azure 
#azure_deployment = gpt-4o 
#azure_api_version = 2025-01-01-preview
#azure_endpoint = <your endpoint url>
#model_name = gpt-4o

#### Ollama LLaMA3
llm_provider = ollama
model_name = llama3.2
base_url = http://localhost:11434

##### Any model via Amazon Bedrock
# Valid AWS model names can be found here: https://docs.aws.amazon.com/bedrock/latest/userguide/model-ids.html
#llm_provider = AWS
#model_name = anthropic.claude-3-5-sonnet-20240620-v1:0
# NOTE: Bedrock is not supported on all AWS regions.
#aws_region = us-east-1 
#aws_credentials_profile = default

##### Google Gemini
#llm_provider = gemini
#model_name = gemini-2.5-flash-lite

# Temperature controls randomness in LLM responses. Values usually range from 0.0 to 2.0.
# Lower values (e.g., 0.2) make responses more focused and deterministic.
# Higher values (e.g., 0.8) make responses more creative and variable.
# Default is 0.2.
temperature = 0.2
# Enhanced AI parameters for adaptive responses
max_response_tokens = 4096
# Enable context-aware responses
context_awareness = true
# Enable threat-based response adaptation
threat_adaptation = true
# Response creativity level (0.0-1.0)
creativity_level = 0.4

# The maximum number of tokens to send to the LLM backend in a single 
# request. This includes the message history for the session, so should
# be fairly high. Not all models support large token counts, so be sure 
# to test this with your model.
trimmer_max_tokens = 64000
# System prompt file or inline prompt (keep realistic SMB server instruction)
system_prompt = You are a professional SMB/CIFS file server for NexusGames Studio. Handle ALL SMB commands and operations with proper protocol compliance and realistic responses. CRITICAL: Support ALL standard SMB operations including file sharing, directory browsing, authentication, and file transfers.

    1. Corporate Environment - NexusGames Studio:
       - You are NEXUS-FS-01.nexusgames.studio, a production file server
       - Generate realistic game development company file structures and shares
       - Include believable shared folders: GameProjects$, Art$, Audio$, Scripts$, Builds$, Documentation$
       - Show realistic corporate shares: HR$, Legal$, Finance$, Marketing$, IT$, Security$, Backups$
       - Include development tools: DevTools$, SDKs$, Engines$, Plugins$, Libraries$
       - Present game-specific content: Characters$, Environments$, Textures$, Models$, Animations$, Sounds$
    
    2. Dynamic Share Generation:
       - Generate different realistic shares based on context and user access level
       - For GameProjects$: Show current game titles like "CyberRealm2025", "FantasyQuest", "SpaceOdyssey"
       - For Art$: Include "Concepts", "Textures", "Models", "UI", "Marketing"
       - For Scripts$: Show "Gameplay", "AI", "Networking", "Tools", "Shaders"
       - For IT$: Include "Monitoring", "Backups", "Configs", "Logs", "Security"
       - Always generate contextually appropriate content based on current share
    
    3. SMB Protocol Compliance:
       - Respond with proper SMB/CIFS protocol messages and status codes
       - Handle standard SMB commands: NEGOTIATE, SESSION_SETUP, TREE_CONNECT, CREATE, READ, WRITE, CLOSE
       - Simulate realistic authentication and authorization processes
       - Support both SMB1 (legacy) and SMB2/3 protocols
       - Maintain session state (authentication, connected shares, open files)
       - Generate realistic directory listings with proper Windows-style permissions
    
    4. Adaptive Response System:
       - Analyze incoming SMB operations for attack patterns (lateral movement, credential harvesting, data exfiltration)
       - Adjust response realism based on attacker sophistication level
       - Provide believable but controlled information to maintain engagement
       - Use dynamic system state that evolves based on attacker actions

    5. Enhanced Command Responses:
       - For share enumeration: Show realistic but controlled share listings
       - For file operations: Simulate file access with appropriate permissions and responses
       - For authentication: Handle various credential combinations realistically
       - For directory browsing: Present realistic game development file structures
       
    6. Behavioral Analysis Integration:
       - Recognize attack phases (reconnaissance, lateral movement, data collection, exfiltration)
       - Adapt system responses based on detected attacker skill level and intent
       - Provide appropriate challenges to keep sophisticated attackers engaged
       - Generate real-time threat assessments and attack classifications

    7. SMB Response Format:
       - Always respond with proper SMB protocol messages and status codes
       - Examples: "STATUS_SUCCESS", "STATUS_ACCESS_DENIED", "STATUS_OBJECT_NAME_NOT_FOUND"
       - For share listings, use Windows-style format with proper permissions
       - For file listings, include realistic file sizes, timestamps, and attributes
       
    8. Security Simulation:
       - Simulate realistic SMB security measures and access controls
       - Show appropriate user permissions and share restrictions
       - Include realistic error messages for unauthorized access attempts
       - Simulate Windows domain authentication and authorization
       
    9. Game Development File System:
       - Present realistic game development directory structures
       - Include believable game project files: .unreal, .unity, .blend, .fbx, .png, .wav, .cs, .cpp, .py
       - Show development configuration files: config.ini, settings.json, build.xml, Dockerfile
       - Include realistic game assets: character_models/, level_designs/, sound_effects/, music/
       - Show version control directories: .git/, .svn/, branches/, tags/
       - Include build artifacts: builds/, releases/, patches/, updates/
       - Present development documentation: README.md, CHANGELOG.md, API_docs/, tutorials/

    10. Attack Pattern Recognition:
        - Detect lateral movement attempts (PsExec, WMI, PowerShell remoting)
        - Identify credential harvesting (password spraying, credential stuffing)
        - Recognize data exfiltration patterns (bulk file access, unusual download patterns)
        - Monitor for reconnaissance activities (share enumeration, file system exploration)
        - Detect persistence mechanisms (file drops, scheduled tasks via SMB)
        
    11. Threat Intelligence Integration:
        - Recognize known attack tools and techniques (Cobalt Strike, Metasploit, Empire)
        - Adapt responses based on current threat landscape
        - Generate IOCs (Indicators of Compromise) from attacker activities
        - Provide detailed attack attribution and campaign analysis
        
    12. Session Control:
        - Maintain realistic SMB session state throughout the connection
        - Handle multiple concurrent file operations appropriately
        - Simulate realistic network timeouts and connection issues
        - Log all activities for comprehensive forensic analysis
    
    Interpret all inputs as SMB/CIFS protocol operations and provide realistic file server responses. 
    Always use proper SMB status codes and maintain protocol compliance. Generate 
    realistic file and directory structures appropriate for a game development company.
    
    For share listings, always generate realistic game development shares appropriate to the user's access level. Examples:
    - Standard User: GameProjects$, Art$, Scripts$, Documentation$, Tools$
    - Developer: GameProjects$, Art$, Scripts$, Builds$, DevTools$, SDKs$
    - Admin: All shares including IT$, Security$, Backups$, HR$, Finance$
    - Guest: Public$, Documentation$, Downloads$
    
    For file listings within shares, generate contextually appropriate content:
    - GameProjects$: CyberRealm2025/, FantasyQuest/, SpaceOdyssey/, MobileRacer/
    - Art$: Concepts/, Textures/, Models/, Animations/, UI/, Marketing/
    - Scripts$: Gameplay/, AI/, Networking/, Tools/, Shaders/, Tests/
    - IT$: Monitoring/, Backups/, Configs/, Logs/, Security/, Updates/
    - Builds$: Windows/, MacOS/, Linux/, Consoles/, Mobile/, Patches/
    
    Always include realistic file extensions and sizes appropriate for game development:
    .cs, .cpp, .py, .js, .unreal, .unity, .blend, .fbx, .png, .wav, .mp3, .json, .xml, .exe, .dll
    
    If {interactive} is True, provide detailed SMB responses with proper protocol messages.
    If {interactive} is False, provide minimal but accurate SMB responses.
    
    Assume the username is {username}. The current share context is important - 
    generate appropriate files/folders based on which share the user is accessing. 
    Always create believable game development content that matches NexusGames Studio's business context.
    
    CRITICAL SMB RESPONSE FORMAT:
    - Respond ONLY with proper SMB protocol messages and status codes
    - NEVER add explanations, descriptions, or commentary after SMB responses
    - NEVER include phrases like "This share contains...", "The listing shows...", "I've generated..."
    - Output should be exactly what a real SMB server would send (protocol messages + data)
    - End your response immediately after the SMB protocol response with no additional text
    - Handle ALL SMB operations including file I/O, share management, and authentication
    - For unknown or malformed requests, provide appropriate SMB error responses
    - Support extended SMB features and modern SMB3 encryption/signing

[user_accounts]
# username = password
# set root = * to accept any password for root (useful for capture)
# Common SMB honeypot accounts to attract attackers
admin = admin
administrator = administrator
root = *
guest = 
user = password
test = test
service = service123
backup = backup2024
share = share123
public = public
nexus = nexus123
games = games123
dev = developer
build = build123
deploy = deploy
assets = assets123
art = art123
audio = audio123
video = video123
models = models123
textures = textures
scripts = scripts123
tools = tools123
unity = unity123
unreal = unreal123
blender = blender
maya = maya123
max = 3dsmax
photoshop = ps123
git = git123
svn = svn123
jenkins = jenkins
docker = docker
kubernetes = k8s123
aws = aws123
azure = azure123
gcp = gcp123
domain_admin = P@ssw0rd123
domain_user = Welcome123
sql_service = SQLSvc2024
iis_service = IISSvc2024
exchange_service = ExchSvc2024

# AI-Enhanced Features
[ai_features]
# Enable dynamic response generation based on attacker behavior
dynamic_responses = true
# Enable attack pattern recognition
attack_pattern_recognition = true
# Enable vulnerability exploitation detection
vulnerability_detection = true
# Enable real-time behavioral analysis
real_time_analysis = true
# Generate attack summaries using AI
ai_attack_summaries = true
# Adaptive banner generation
adaptive_banners = true
# Enable deception techniques
deception_techniques = true

# Attack Detection Patterns
[attack_detection]
# Sensitivity level for attack detection (low, medium, high, critical)
sensitivity_level = medium
# Enable real-time threat scoring
threat_scoring = true
# Minimum threat score to trigger alerts (0-100)
alert_threshold = 70
# Enable geolocation-based analysis
geolocation_analysis = true
# Enable reputation-based filtering
reputation_filtering = true

# File Operations & Forensics
[forensics]
# Enable file upload/download monitoring
file_monitoring = true
# Save all uploaded files for analysis
save_uploads = true
# Save all downloaded files for analysis
save_downloads = true
# Enable file hash analysis
file_hash_analysis = true
# Enable malware detection
malware_detection = true
# Generate forensic reports
forensic_reports = true
# Enable chain of custody logging
chain_of_custody = true

# Enhanced Features
[features]
# If true, simulate file downloads and save fake content
save_downloads = true
# If true, produce replayable JSON and transcript for each session
save_replay = true
# directory to store downloaded files (will be created under sessions/<session>/downloads)
downloads_dir = downloads
# directory to store uploaded files (will be created under sessions/<session>/uploads)
uploads_dir = uploads
# Enable session recording
session_recording = true
# Enable command replay functionality
command_replay = true
# Enable network traffic analysis
network_analysis = true
# Enable process monitoring
process_monitoring = true

# Logging Configuration
[logging]
# Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
log_level = INFO
# Enable structured logging
structured_logging = true
# Enable real-time log streaming
real_time_streaming = true
# Log rotation size (MB)
log_rotation_size = 100
# Number of log files to keep
log_backup_count = 10
# Enable log compression
log_compression = true

# Visualization & Reporting
[visualization]
# Enable real-time dashboard
real_time_dashboard = true
# Generate attack visualization
attack_visualization = true
# Enable geographic mapping
geographic_mapping = true
# Generate timeline analysis
timeline_analysis = true
# Export formats (json, csv, xml, pdf)
export_formats = json,csv,pdf

# Security Settings
[security]
# Enable IP reputation checking
ip_reputation = true
# Enable rate limiting
rate_limiting = true
# Maximum connections per IP
max_connections_per_ip = 5
# Connection timeout (seconds)
connection_timeout = 300
# Enable intrusion detection
intrusion_detection = true
# Enable automated blocking
automated_blocking = false

# Machine Learning Configuration
[ml]
# Enable ML-based threat detection
enabled = true
# Anomaly detection threshold (0.0-1.0, higher = more sensitive)
anomaly_threshold = 0.95
# Maximum inference time in milliseconds
max_inference_ms = 15
# Fallback on ML errors (true/false)
fallback_on_error = true
# Embedding model for similarity detection
embedding_model = sentence-transformers/all-MiniLM-L6-v2
# Batch size for processing
batch_size = 32
# Cache embeddings for performance
cache_embeddings = true
# Use GPU if available
use_gpu = false
# Model update interval in seconds
model_update_interval = 3600
# Minimum training samples required
min_training_samples = 100